{% extends "ttn/community/base.html" %}
{% load staticfiles %}

{% block author %}
                {% for leader in community.leaders.all %}
                <img class="inititator" src="{% static 'ttn/media/team/wienke.jpg' %}">
                <h2 class="initiator-name">{{ leader.first_name }} {{ leader.last_name }}</h2>
                <h3 class="initiator-city">Initiator for {{ community.title }}</h3>
                {% endfor %}
{% endblock %}

{% block extra_js %}
<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script>
      function initialize() {
        var mapCanvas = document.getElementById('map');
        var mapOptions = {
          center: new google.maps.LatLng(
                {{ community.lat|default:'44.5403' }},
                {{ community.lng|default:'-78.5463' }}),
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        var map = new google.maps.Map(mapCanvas, mapOptions)
      }
      google.maps.event.addDomListener(window, 'load', initialize);
</script>
{% endblock %}


{% block content %}
            <article class="intro">
                <h1>The Things Network in {{ community.title }}<h1>
                        <p>{{ community.leaders.first.first_name }} {{ community.leaders.first.last_name }} has taken the job upon him to rollout The Things Network in {{ community.title }}. Beneath you can see the parts which are already covered. Be a part of the movement and join him to complete his task! </p>
			{% if community.description %}
			<p>{{ community.description }}</p>
			{% endif %}
            </article>
            
            <section class="coverage-progress">
                <!-- div class="progress">
                    <h1>Progress</h1>
                    <img src="{% static 'ttn/media/progress.png' %}">
                </div -->
                <div id="map">testing</div>
		<!-- https://developers.google.com/maps/documentation/staticmaps/intro -->
            </section>
            
        <article class="how-to-connect">
            <h1>Stay up to date</h1>
                <section class="article-text"><p>Want to know more about The Things Network? Sign up for our newsletter and receive all the important news.</p></section>
                <!-- Begin MailChimp Signup Form -->
                <div id="mc_embed_signup">
                    <form action="//thethingsnetwork.us11.list-manage.com/subscribe/post?u=20406705fec6d7d4b2ab1d6cc&amp;id=0b4108dfeb" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                        <div id="mc_embed_signup_scroll">
                            <div class="mc-field-group">
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Fill in your email address">
                            </div>
	                       <div id="mce-responses" class="clear">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                               </div>
                            </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                            <div style="position: absolute; left: -5000px;"><input type="text" name="b_20406705fec6d7d4b2ab1d6cc_0b4108dfeb" tabindex="-1" value=""></div>
                            <div class="clear">
                            <br>
                                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                            </div>
                        </div>
                    </form>
                </div>
<!--End mc_embed_signup-->
        </article>    
            
            <article class="information">
                <section class="left-bar">
                    <h1>Contributors</h1>
                    {# TODO #}
                    {% if community.slug == 'amsterdam' %}
                    <img class="contributor" src="{% static 'ttn/media/team/contributor.jpg' %}">
                    <img class="contributor" src="{% static 'ttn/media/team/martijn van der veen.png' %}">
                    <img class="contributor" src="{% static 'ttn/media/team/johan.jpg' %}">
                    <img class="contributor" src="{% static 'ttn/media/team/fokko visser.png' %}">
                    <img class="contributor" src="{% static 'ttn/media/team/contributor.jpg' %}">
                    {% endif %}
                </section>
            
                <section class="center">
                    <div class="blog-posts">
                        <h1>Posts</h1>
                            {% if community.post_set.all %}
                            {% for post in community.post_set.all %}
                            <div class="blog-post">
                                <div class="blog-image"></div>
                                
                                    <div class="blog-text">
                                        <h4>{{ post.title }}</h4>
                                        <p>{{ post.description|truncatewords:50 }}</p>
                                        <a href="{% url 'ttn:community-post' slug=community.slug pk=post.pk %}">
                                            Read more
                                        </a>
                                    </div>
                            </div>
                            {% endfor %}
                            {% else %}
                            <div class="blog-post">
                                <p>The {{ community.title }} community hasn't posted anything yet!</p>
                                <p><a href="{% url 'ttn:community-contact' slug=community.slug %}">
                                    Ask {{ community.leaders.first.first_name }} why
                                </a></p>
                            </div>
                            {% endif %}
                    </div>
                </section>
            
                <section class="right-bar">
                    <h1>Media</h1>
                    {% if community.media_set.all %}
                    {% for medium in community.media_set.all %}
                    <div class="side-post">
                        <h4>{{ medium.title }}</h4>
                        <a href="{{ medium.url }}" target="_blank">read more</a>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="side-post">
                        The {{ community.title }} community is working on media attention!
                    </div>
                    {% endif %}

                    <div class="vseperator">&nbsp;</div>

                    <h1>Resources</h1>
                    {% if community.resource_set.all %}
                    {% for resource in community.resource_set.all %}
                    <div class="side-post">
                        <h4>{{ resource.title }}</h4>
                        <a href="{{ resource.url }}" target="_blank">have a look</a>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="side-post">
                        We don't have any external resources yet.
                    </div>
                    {% endif %}
                </section>
         </article>

{% endblock %}
